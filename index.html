<!DOCTYPE html>
<html lang="es">
<head><meta charset="utf-8"><title>Test Sheets</title></head>
<body>
  <label>Nombre: <input id="nombre"></label><br>
  <label>Territorio: <input id="territorio"></label><br>
  <label>Fecha: <input id="fecha" type="date"></label><br>
  <button id="btn">Enviar</button>
  <pre id="out"></pre>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxSULWilNYI--yyZn42yHhhnImG1GogGXQ-Y5GzLsyhkz5VNcdI4RYHmhyriervmsTX/exec";

document.getElementById('btn').addEventListener('click', async () => {
  const out = document.getElementById('out');
  out.textContent = 'Enviando...';
  const fd = new FormData();
  fd.append('nombre', document.getElementById('nombre').value);
  fd.append('territorio', document.getElementById('territorio').value);
  fd.append('fecha', document.getElementById('fecha').value);

  try {
    const res = await fetch(SCRIPT_URL, { method: 'POST', body: fd });
    const text = await res.text();
    out.textContent = 'HTTP ' + res.status + '\\n' + text;
    try { out.textContent += '\\nPARSE: ' + JSON.stringify(JSON.parse(text)); } catch(e){}
  } catch (err) {
    out.textContent = 'Fetch error: ' + err;
    console.error(err);
  }
});
</script>
</body>
</html>
